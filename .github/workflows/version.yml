name: Generate Release Version

on:
  workflow_call:
    outputs:
      version:
        description: "Automatic Version Number"
        value: ${{ jobs.versioner.outputs.version }}
    inputs:
      major:
        type: string
        description: "Major version"
        required: true
      minor:
        type: string
        description: "Minor version"
        required: true
      patch:
        type: string
        description: "Patch version"
        required: true
      increment:
        type: string
        description: "Increment value"
        required: false

jobs:
  versioner:
    runs-on: ubuntu-latest
    name: Generate Version
    outputs:
      version: ${{ steps.version.outputs.version }}
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

      - name: Semantic Version
        id: version
        uses: paulhatch/semantic-version@v5.0.2
        with:
          bump_each_commit: true
          search_commit_body: true
          version_format: "${{ inputs.major }}.${{ inputs.minor }}.${{ inputs.patch }}.${patch}"
          # tag_prefix: "v"
          # bump_each_commit_patch_pattern: ""
        # version_format: "${major}.${minor}.${patch}"
        # traditional triggers
        # https://gitversion.net/docs/reference/version-increments
        # major-version-bump-message: "^(build|chore|ci|docs|feat|fix|perf|refactor|revert|style|test)(\\([\\w\\s-]*\\))?(!:|:.*\\n\\n((.+\\n)+\\n)?BREAKING CHANGE:\\s.+)"
        # minor-version-bump-message: "^(feat)(\\([\\w\\s-]*\\))?:"
        # patch-version-bump-message: "^(build|chore|ci|docs|fix|perf|refactor|revert|style|test)(\\([\\w\\s-]*\\))?:"

      # - name: Set Version
      #   id: version
      #   run: |
      #     echo "version=${{ inputs.major }}.${{ inputs.minor }}.${{ inputs.patch }}.${{ inputs.increment }}" >> $env:GITHUB_OUTPUT
